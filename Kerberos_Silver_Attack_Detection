title: Potential Silver Ticket Attack - Missing TGT and TGS Request

description: Detects Kerberos service ticket (4769) usage without preceding TGT request (4768) for same account, indicative of forged Silver Ticket.

tags:
  - attack.credential_access
  - attack.t1558.002
references:
  - https://www.semperis.com/blog/how-to-defend-against-silver-ticket-attacks/
  - https://adsecurity.org/?p=1515
logsource:
  product: windows
  service: security
detection:
  service_ticket_used:
    EventID: 4769
    ServiceName|startswith:
      - 'CIFS/'
      - 'HOST/'
      - 'MSSQLSvc/'
      - 'HTTP/'
      - 'LDAP'
    Status: '0x0'
  tgt_requested:
    EventID: 4768
    tgs_issued: EventID: 4769 
    ServiceName|contains: 'krbtgt/' 

condition: service_ticket_used and not (tgt_requested or tgs_issued)

falsepositives:
  - Cached tickets may cause missing 4768 events.
  - Constrained delegation scenarios.
level: high
